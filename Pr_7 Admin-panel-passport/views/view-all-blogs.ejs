<%- include('header') %>

<style>
  /* --- Card Layout Styling --- */
  .blog-card {
  width: 100%;
  max-width: 360px;        /* card width */
  border-radius: 12px;
  overflow: hidden;
  margin: 0 auto;
  transition: transform 0.28s ease, box-shadow 0.28s ease;
  display: flex;
  flex-direction: column;
  background: #ffffff;
  border: 1px solid rgba(0,0,0,0.06);
}

/* image */
.blog-card img {
  width: 100%;
  height: 200px;
  object-fit: cover;
  display: block;
}

/* body */
.blog-card .card-body {
  padding: 14px;
  display: flex;
  flex-direction: column;
  flex: 1;
  justify-content: space-between;
}

/* title and text */
.blog-card .card-title {
  font-size: 1.05rem;
  font-weight: 600;
  margin-bottom: 6px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.blog-card .card-text {
  font-size: 0.92rem;
  color: #6c757d;
  margin-bottom: 6px;
}

/* footer area (button) */
.blog-card .card-body .mt-2 {
  margin-top: 10px;
}

/* hover */
.blog-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 12px 30px rgba(30, 40, 50, 0.12);
}

/* responsive grid item container alignment (ensure consistent height) */
.row .blog-card {
  min-height: 360px;
}

/* small screens: full width cards and smaller image */
@media (max-width: 767.98px) {
  .blog-card {
    max-width: 100%;
    min-height: auto;
  }
  .blog-card img {
    height: 180px;
  }
}

/* utility: truncate multi-line excerpt (if you add an excerpt later) */
.text-truncate-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* button full width on small screens */
@media (max-width: 575.98px) {
  .blog-card .btn {
    width: 100% !important;
  }
}
</style>

<div class="page-wrapper">
  <!-- ============================================================== -->
  <!-- Bread crumb -->
  <!-- ============================================================== -->
  <div class="page-breadcrumb">
    <div class="row">
      <div class="col-6 d-flex align-items-center">
        <h4 class="page-title">All Blogs</h4>
      </div>
      <div class="col-6 d-flex justify-content-end">
        <a href="/blog/my-blogs" class="btn btn-sm" style="background-color:#7460ee; color:#fff; border:none;">
          <i class="fas fa-user"></i> My Blogs
        </a>
      </div>
    </div>
  </div>

  <!-- ============================================================== -->
  <!-- Container fluid -->
  <!-- ============================================================== -->
  <div class="container-fluid mt-4">

    <!-- Category Filter -->
    <div class="mb-3">
      <strong>Filter by Category:</strong>
      <% if (categories && categories.length > 0) { %>
        <% categories.forEach(cat => { %>
          <a href="/blog/view-all-blogs?category=<%= cat %>" class="btn btn-outline-primary btn-sm m-1">
            <%= cat %>
          </a>
        <% }) %>
      <% } %>
      <a href="/blog/view-all-blogs" class="btn btn-secondary btn-sm m-1">All</a>
    </div>

    <!-- Blog Cards -->
    <div class="row justify-content-center">
      <% if (blogs && blogs.length > 0) { %>
        <% blogs.forEach(blog => { %>
          <div class="col-lg-4 col-md-6 col-sm-12 mb-4 d-flex justify-content-center">
            <div class="card blog-card shadow-sm">
              <img 
                src="<%= blog.image && blog.image.trim() !== '' ? blog.image : '/uploads/default.jpg' %>" 
                alt="Blog Image"
                onerror="this.src='/uploads/default.jpg'"
              >
              <div class="card-body">
                <div>
                  <h5 class="card-title text-truncate" title="<%= blog.title %>"><%= blog.title %></h5>
                  <p class="card-text mb-1"><strong>By:</strong> <%= blog.author || 'Unknown' %></p>
                  <p class="card-text mb-1"><strong>Category:</strong> <%= blog.category || 'N/A' %></p>
                  <p class="card-text mb-1"><strong>Language:</strong> <%= blog.language || 'N/A' %></p>
                  <p class="card-text"><strong>Date:</strong> <%= new Date(blog.createdAt).toLocaleDateString() %></p>
                </div>

                <div class="mt-2">
                  <a href="/blog/single-blog/<%= blog._id %>" class="btn btn-info btn-sm w-100">
  <i class="fas fa-eye"></i> Read More
</a>
                </div>
              </div>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <div class="col-12 text-center text-muted">
          <h5>No blogs found!</h5>
        </div>
      <% } %>
    </div>

  </div>
</div>

<%- include('footer') %>
